# Render Blueprint â€” deploy with "New > Blueprint Instance"
# https://render.com/docs/blueprint-spec

services:
  - type: web
    name: thread
    runtime: node
    plan: free                    # or starter ($7/mo for persistent disk)
    buildCommand: npm ci && npm run build
    startCommand: node server/index.js
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: HOST
        value: 0.0.0.0
      - key: JWT_SECRET
        generateValue: true       # Render generates a random secret
      - key: GEMINI_API_KEY
        sync: false               # Set manually in dashboard
      - key: DATABASE_PATH
        value: /data/thread.db    # Persistent disk mount
    disk:
      name: thread-data
      mountPath: /data
      sizeGB: 1                   # $0.25/mo on starter plan
